!! options
version=2
requirements=extension:WikimediaMessages
!! end

!! article
Test
!! text
Prevent red links in parser tests
!! end

!! article
Template:Wish
!! text
This is a test template for parser tests
!! end

!! test
Empty wish parser tag
!! wikitext
{{#CommunityRequests: wish}}
!! html
!! end

!! test
Example wish
!! options
title=Community_Wishlist/Wishes/W1
!! wikitext
{{#CommunityRequests: wish
|title = Test Wish
|status = prioritized
|type = change
|audience = [[Test]] audience
|tags = multimedia,wikisource
|otherproject = Some other project
|phabtasks = T123,T456
|created = 2023-10-01T12:00:00Z
|proposer = Admin
|baselang = en
|description = This is a [[test]] {{wish}}.}}
!! html
<div class="ext-communityrequests-wish"><div class="mw-heading mw-heading2 ext-communityrequests-wish--heading"><span class="ext-communityrequests-wish--title">Test Wish</span><span class="cdx-info-chip ext-communityrequests-wish--status cdx-info-chip--notice"><span class="cdx-info-chip__text">Prioritized</span></span></div><div class="mw-heading mw-heading3">Description</div><div class="ext-communityrequests-wish--description">
<p>This is a <a href="/wiki/Test" title="Test">test</a> This is a test template for parser tests.
</p>
</div><div class="mw-heading mw-heading3">Assigned focus area</div><div class="ext-communityrequests-wish--focus-area">
<p>Unassigned
</p>
</div><div class="mw-heading mw-heading3">Type of wish</div><p class="ext-communityrequests-wish--wish-type">System change</p><div class="mw-heading mw-heading3">Tags</div><p class="ext-communityrequests-wish--tags">Multimedia and Commons, Wikisource</p><div class="mw-heading mw-heading3">Affected users</div><div class="ext-communityrequests-wish--audience">
<p><a href="/wiki/Test" title="Test">Test</a> audience
</p>
</div><div class="mw-heading mw-heading3">Phabricator tasks</div><div class="ext-communityrequests-wish--phabtasks">
<p><a href="http://example.org/wiki/phab:T123" class="extiw" title="phab:T123">T123</a>, <a href="http://example.org/wiki/phab:T456" class="extiw" title="phab:T456">T456</a>
</p>
</div><div class="mw-heading mw-heading3">Other details</div><ul><li class="ext-communityrequests-wish--created">Created: 12:00, 1 October 2023</li><li class="ext-communityrequests-wish--updated">Last updated: 00:02, 1 January 1970</li><li class="ext-communityrequests-wish--proposer">Author: <a href="/index.php?title=User:Admin&amp;action=edit&amp;redlink=1" class="new" title="User:Admin (page does not exist)">Admin</a> (<a href="/index.php?title=User_talk:Admin&amp;action=edit&amp;redlink=1" class="new" title="User talk:Admin (page does not exist)">talk</a>)</li></ul><div class="mw-heading mw-heading2" id="Voting">Voting</div><div class="ext-communityrequests-wish--voting"><p>This wish currently has <b>0 supporters</b>. Voting for this wish is open until it is completed. Show your support using the button below.</p><div class="ext-communityrequests-voting-btn"></div></div></div>
!! end

!! test
Example wish with declined status
!! options
title=Community_Wishlist/Wishes/W2
!! wikitext
{{#CommunityRequests: wish
|title = Test Wish with Voting Disabled
|status = declined
|type = change
|audience = Example audience
|tags = multimedia,wikisource
|phabtasks = T123,T456
|created = 2023-10-01T12:00:00Z
|proposer = Admin
|baselang = en
|description = This is a wish without voting.}}
!! html
<div class="ext-communityrequests-wish"><div class="mw-heading mw-heading2 ext-communityrequests-wish--heading"><span class="ext-communityrequests-wish--title">Test Wish with Voting Disabled</span><span class="cdx-info-chip ext-communityrequests-wish--status cdx-info-chip--notice"><span class="cdx-info-chip__text">Declined</span></span></div><div class="mw-heading mw-heading3">Description</div><div class="ext-communityrequests-wish--description">
<p>This is a wish without voting.
</p>
</div><div class="mw-heading mw-heading3">Assigned focus area</div><div class="ext-communityrequests-wish--focus-area">
<p>Unassigned
</p>
</div><div class="mw-heading mw-heading3">Type of wish</div><p class="ext-communityrequests-wish--wish-type">System change</p><div class="mw-heading mw-heading3">Tags</div><p class="ext-communityrequests-wish--tags">Multimedia and Commons, Wikisource</p><div class="mw-heading mw-heading3">Affected users</div><div class="ext-communityrequests-wish--audience">
<p>Example audience
</p>
</div><div class="mw-heading mw-heading3">Phabricator tasks</div><div class="ext-communityrequests-wish--phabtasks">
<p><a href="http://example.org/wiki/phab:T123" class="extiw" title="phab:T123">T123</a>, <a href="http://example.org/wiki/phab:T456" class="extiw" title="phab:T456">T456</a>
</p>
</div><div class="mw-heading mw-heading3">Other details</div><ul><li class="ext-communityrequests-wish--created">Created: 12:00, 1 October 2023</li><li class="ext-communityrequests-wish--updated">Last updated: 00:02, 1 January 1970</li><li class="ext-communityrequests-wish--proposer">Author: <a href="/index.php?title=User:Admin&amp;action=edit&amp;redlink=1" class="new" title="User:Admin (page does not exist)">Admin</a> (<a href="/index.php?title=User_talk:Admin&amp;action=edit&amp;redlink=1" class="new" title="User talk:Admin (page does not exist)">talk</a>)</li></ul><div class="mw-heading mw-heading2" id="Voting">Voting</div><div class="ext-communityrequests-wish--voting"><p>This wish currently has <b>0 supporters</b>. Supporting this wish is currently disabled.</p></div></div>
!! end

!! test
Example wish with done status
!! options
title=Community_Wishlist/Wishes/W2
!! wikitext
{{#CommunityRequests: wish
|title = Test Wish with Voting Disabled
|status = done
|type = change
|audience = Example audience
|tags = multimedia,wikisource
|phabtasks = T123,T456
|created = 2023-10-01T12:00:00Z
|proposer = Admin
|baselang = en
|description = This is a wish without voting.}}
!! html
<div class="ext-communityrequests-wish"><div class="mw-heading mw-heading2 ext-communityrequests-wish--heading"><span class="ext-communityrequests-wish--title">Test Wish with Voting Disabled</span><span class="cdx-info-chip ext-communityrequests-wish--status cdx-info-chip--success"><span class="cdx-info-chip__text">Done</span></span></div><div class="mw-heading mw-heading3">Description</div><div class="ext-communityrequests-wish--description">
<p>This is a wish without voting.
</p>
</div><div class="mw-heading mw-heading3">Assigned focus area</div><div class="ext-communityrequests-wish--focus-area">
<p>Unassigned
</p>
</div><div class="mw-heading mw-heading3">Type of wish</div><p class="ext-communityrequests-wish--wish-type">System change</p><div class="mw-heading mw-heading3">Tags</div><p class="ext-communityrequests-wish--tags">Multimedia and Commons, Wikisource</p><div class="mw-heading mw-heading3">Affected users</div><div class="ext-communityrequests-wish--audience">
<p>Example audience
</p>
</div><div class="mw-heading mw-heading3">Phabricator tasks</div><div class="ext-communityrequests-wish--phabtasks">
<p><a href="http://example.org/wiki/phab:T123" class="extiw" title="phab:T123">T123</a>, <a href="http://example.org/wiki/phab:T456" class="extiw" title="phab:T456">T456</a>
</p>
</div><div class="mw-heading mw-heading3">Other details</div><ul><li class="ext-communityrequests-wish--created">Created: 12:00, 1 October 2023</li><li class="ext-communityrequests-wish--updated">Last updated: 00:02, 1 January 1970</li><li class="ext-communityrequests-wish--proposer">Author: <a href="/index.php?title=User:Admin&amp;action=edit&amp;redlink=1" class="new" title="User:Admin (page does not exist)">Admin</a> (<a href="/index.php?title=User_talk:Admin&amp;action=edit&amp;redlink=1" class="new" title="User talk:Admin (page does not exist)">talk</a>)</li></ul><div class="mw-heading mw-heading2" id="Voting">Voting</div><div class="ext-communityrequests-wish--voting"><p>This wish currently has <b>0 supporters</b>. Supporting this wish is currently disabled.</p></div></div>
!! end

!! test
Missing proposer and created timestamp
!! options
title=Community_Wishlist/Wishes/W3
!! wikitext
{{#CommunityRequests: wish
|title = Wish without proposer
|status = under-review
|type = change
|audience = Example audience
|projects = commons,wikisource
|otherproject = Some other project
|phabtasks = T123,T456
|baselang = en
|description = This is a wish without a proposer or created timestamp.}}
!! html
<p class="error">Missing required fields: created, proposer</p>
!! end

!! test
Example wish in Hebrew and with no tasks
!! options
title=Community_Wishlist/Wishes/W4
language=qqx
!! wikitext
{{#CommunityRequests: wish
|title = משאלת מבחן (Hebrew)
|status = submitted
|type = change
|audience = קהל לדוגמה
|tags = multimedia,wikisource
|otherproject = פרויקט אחר כלשהו
|created = 2023-10-01T12:00:00Z
|proposer = Admin
|baselang = he
|description = זהו [[test]] {{wish}}}}
!! html
<div class="ext-communityrequests-wish"><div class="mw-heading mw-heading2 ext-communityrequests-wish--heading"><span class="ext-communityrequests-wish--title">משאלת מבחן (Hebrew)</span><span class="cdx-info-chip ext-communityrequests-wish--status cdx-info-chip--notice"><span class="cdx-info-chip__text">(communityrequests-status-unknown)</span></span></div><div class="mw-heading mw-heading3">(communityrequests-wish-description-heading)</div><div class="ext-communityrequests-wish--description">
<p>זהו <a href="/wiki/Test" title="Test">test</a> This is a test template for parser tests
</p>
</div><div class="mw-heading mw-heading3">(communityrequests-wish-focus-area-heading)</div><div class="ext-communityrequests-wish--focus-area">
<p>(communityrequests-focus-area-unassigned)
</p>
</div><div class="mw-heading mw-heading3">(communityrequests-wish-type-heading)</div><p class="ext-communityrequests-wish--wish-type">(communityrequests-wishtype-change-label)</p><div class="mw-heading mw-heading3">(communityrequests-tags-heading)</div><p class="ext-communityrequests-wish--tags">(communityrequests-tag-multimedia-commons)(comma-separator)(communityrequests-tag-wikisource)</p><div class="mw-heading mw-heading3">(communityrequests-wish-audience-heading)</div><div class="ext-communityrequests-wish--audience">
<p>קהל לדוגמה
</p>
</div><div class="mw-heading mw-heading3">(communityrequests-wish-other-details-heading)</div><ul><li class="ext-communityrequests-wish--created">(communityrequests-wish-created: 12:00, 1 (october) 2023)</li><li class="ext-communityrequests-wish--updated">(communityrequests-wish-updated: 00:02, 1 (january) 1970)</li><li class="ext-communityrequests-wish--proposer">(communityrequests-wish-proposer: (signature: Admin, Admin))</li></ul><div class="mw-heading mw-heading2" id="Voting">(communityrequests-wish-voting)</div><div class="ext-communityrequests-wish--voting"><p>(communityrequests-wish-voting-info: 0, 0) (communityrequests-wish-voting-info-closed)</p></div></div>
!! end
